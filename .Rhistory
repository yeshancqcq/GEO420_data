coverage[j,i] <- 0
} else {
coverage[j,i] <- coverage[j,2]
}
}
}
for(i in 0:220){
colName <- i
coverage$i <- NA
for(j in 1:nrow(coverage)){
if(is.na(metadata[j, i+13])){
coverage[j,i] <- 0
} else {
coverage[j,i] <- coverage[j,2]
}
}
}
for(i in 0:220){
for(j in 1:nrow(coverage)){
if(is.na(metadata[j, i+13])){
coverage[j,i] <- 0
} else {
coverage[j,i] <- coverage[j,2]
}
}
}
View(coverage)
coverage <- data.frame(ID=metadata$ID, Lat=metadata$Latitude, Lon=metadata$Longitude)
View(coverage)
coverage$Lat[3]
for(i in 0:220){
coverage$new <- NA
for(j in 1:nrow(coverage)){
if(is.na(metadata[j, i+13])){
coverage$new[j] <- 0
} else {
coverage$new[j] <- coverage[j,2]
}
}
colnames(coverage)[3+i] <- toString(i)
}
View(coverage)
coverage <- data.frame(ID=metadata$ID, Lat=metadata$Latitude, Lon=metadata$Longitude)
for(i in 0:220){
coverage$new <- NA
for(j in 1:nrow(coverage)){
if(is.na(metadata[j, i+14])){
coverage$new[j] <- 0
} else {
coverage$new[j] <- coverage[j,2]
}
}
colnames(coverage)[4+i] <- toString(i)
}
View(coverage)
coverage <- data.frame(ID=metadata$ID, Lat=metadata$Latitude, Lon=metadata$Longitude)
for(i in 0:220){
coverage$new <- NA
for(j in 1:nrow(coverage)){
if(is.na(metadata[j, i+14])){
coverage$new[j] <- 0
} else {
coverage$new[j] <- coverage$Lat[j]
}
}
colnames(coverage)[4+i] <- toString(i)
}
View(coverage)
coverage$Lat[1]
metadata[1,14]
coverage <- data.frame(ID=metadata$ID, Lat=metadata$Latitude, Lon=metadata$Longitude)
for(i in 0:220){
coverage$new <- NA
for(j in 1:nrow(coverage)){
if(is.na(metadata[j, i+13])){
coverage$new[j] <- 0
} else {
coverage$new[j] <- coverage$Lat[j]
}
}
colnames(coverage)[4+i] <- toString(i)
}
View(coverage)
coverage <- data.frame(ID=metadata$ID, Lat=metadata$Latitude, Lon=metadata$Longitude)
for(i in 0:220){
coverage$new <- NA
for(j in 1:nrow(coverage)){
lat <- coverage$Lat[j]
if(is.na(metadata[j, i+13])){
coverage$new[j] <- NA
} else {
coverage$new[j] <- lat
}
}
colnames(coverage)[4+i] <- toString(i)
}
View(coverage)
metadata <- read_csv("Anomaly_metadata_new.csv")
coverage <- data.frame(ID=metadata$ID, Lat=metadata$Latitude, Lon=metadata$Longitude)
for(i in 0:220){
coverage$new <- NA
for(j in 1:nrow(coverage)){
lat <- coverage$Lat[j]
if(is.na(metadata[j, i+13])){
coverage$new[j] <- NA
} else {
coverage$new[j] <- lat
}
}
colnames(coverage)[4+i] <- toString(i)
}
View(coverage)
plot <- ggplot()
for(i in 4:224){
gg.data <- data.frame(Lat=output[,1], Events=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=Lat, y=Time),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle(maint, subt) +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(0, 35))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
output <- coverage
plot <- ggplot()
for(i in 4:224){
gg.data <- data.frame(Lat=output[,1], Events=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=Lat, y=Time),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(0, 35))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 4:224){
gg.data <- data.frame(Lat=output[,1], Time=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=Time, y=Lat),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(0, 35))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 4:224){
gg.data <- data.frame(Lat=output[,1], Time=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=Lat, y=Time),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(0, 35))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 4:224){
gg.data <- data.frame(Lat=output[,1], Time=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=Time, y=Lat),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(-90,90))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
View(gg.data)
View(coverage)
for (i in 4:224){
k=nrow(coverage)
coverage[k,i]=i-4
}
for (i in 4:224){
k=153
coverage[k,i]=i-4
}
View(coverage)
output <- coverage
plot <- ggplot()
for(i in 4:224){
gg.data <- data.frame(Lat=output[i,], Time=output[153,])
plot<- plot+
geom_line(data=gg.data, aes(x=Time, y=Lat),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(-90,90))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
View(gg.data)
output[i,]
output[1,]
output[153,]
# first remember the names
n <- df.coverage$name
output <- coverage[-3,]
View(output)
output <- data.frame(coverage[-3,])
View(output)
output <- coverage
output[-1]
output <- coverage
output[,-1]
output <- output[,-1]
plot <- ggplot()
output <- output[,-1]
output <- output[,-1]
View(output)
plot <- ggplot()
for(i in 1:152){
gg.data <- data.frame(Lat=output[i,], Time=output[153,])
plot<- plot+
geom_line(data=gg.data, aes(x=Time, y=Lat),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(-90,90))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 1:152){
gg.data <- data.frame( Time=output[153,], Lat=output[i,])
plot<- plot+
geom_line(data=gg.data, aes(x=Time, y=Lat),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(-90,90))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 1:152){
gg.data <- data.frame( Time=output[153,], Lat=output[i,])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(-90,90))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
View(gg.data)
gg.data <- data.frame( Time=(0:220), Lat=output[1,])
View(gg.data)
gg.data <- data.frame( Time=(0:220), Lat=output[1])
View(gg.data)
gg.data <- data.frame( Time=output[153], Lat=output[1,])
View(gg.data)
gg.data <- data.frame( Time=output[153,], Lat=output[1,])
View(gg.data)
gg.data <- data.frame( Time=output[,153], Lat=output[,1])
View(gg.data)
gg.data <- data.frame( Time=output[153,], Lat=output[1,])
View(gg.data)
gg.data <- data.frame( Time=output[153,], Lat=output[2,])
View(gg.data)
output<- as.data.frame(t(output))
View(output)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 0.5, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(-90,90))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 2, colour="#A67C94", alpha = 0.05)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 2, colour="#A67C94", alpha = 0.05)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(-90,90))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 2, colour="#A67C94", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("maint", "subt") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Number of Volcanic Events per 1000 Years"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 18))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 2, colour="#A67C94", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 18))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 2, colour="#A67C94", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 1, colour="#cfcdc8", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")
print(plot)
anomaly_min <- data.frame(xmin = 95, xmax = 105, ymin = -Inf, ymax = Inf)
anomaly_max <- data.frame(xmin = 85, xmax = 120, ymin = -Inf, ymax = Inf)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 1, colour="#cfcdc8", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")+
geom_rect(data=anomaly_min, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="blue", alpha=0.1, inherit.aes = FALSE)+
geom_rect(data=anomaly_max, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="red", alpha=0.05, inherit.aes = FALSE)+
print(plot)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 1, colour="#cfcdc8", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")+
geom_rect(data=anomaly_min, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="blue", alpha=0.1, inherit.aes = FALSE)+
geom_rect(data=anomaly_max, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="red", alpha=0.05, inherit.aes = FALSE)
print(plot)
anomaly_min <- data.frame(xmin = 98, xmax = 105, ymin = -Inf, ymax = Inf)
anomaly_max <- data.frame(xmin = 83, xmax = 120, ymin = -Inf, ymax = Inf)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 1, colour="#cfcdc8", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")+
geom_rect(data=anomaly_min, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="blue", alpha=0.1, inherit.aes = FALSE)+
geom_rect(
anomaly_min <- data.frame(xmin = 98, xmax = 105, ymin = -Inf, ymax = Inf)
anomaly_max <- data.frame(xmin = 83, xmax = 120, ymin = -Inf, ymax = Inf)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 1, colour="#cfcdc8", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Years BP)",
colour = "Parameter")+
geom_rect(data=anomaly_min, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="blue", alpha=0.1, inherit.aes = FALSE)+
geom_rect(data=anomaly_max, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="red", alpha=0.05, inherit.aes = FALSE)
print(plot)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 1, colour="#cfcdc8", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Ka BP)",
colour = "Parameter")+
geom_rect(data=anomaly_min, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="blue", alpha=0.1, inherit.aes = FALSE)+
geom_rect(data=anomaly_max, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="red", alpha=0.05, inherit.aes = FALSE)
print(plot)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 1, colour="#cfcdc8", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data from Marcott et al. and Shakun et al. papers", "with potential periods for anomaly calculation") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Ka BP)",
colour = "Parameter")+
geom_rect(data=anomaly_min, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="blue", alpha=0.1, inherit.aes = FALSE)+
geom_rect(data=anomaly_max, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="red", alpha=0.05, inherit.aes = FALSE)
print(plot)
plot <- ggplot()
for(i in 1:151){
gg.data <- data.frame( Time=output[,153], Lat=output[,i])
plot<- plot+
geom_line(data=gg.data, aes(x=(0:220), y=Lat),size = 1, colour="#cfcdc8", alpha = 1)
}
plot <- plot + scale_x_reverse(limits = c(220, 0),breaks = scales::pretty_breaks(n = 9)) +
ggtitle("Spatiotemporal coverage of paleoclimate data", "with potential periods for anomaly calculation") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))+
scale_y_continuous(name = expression("Latitude"), limits = c(-90,90), breaks = scales::pretty_breaks(n = 9))+
labs(y = "Counts",
x = "Time (Ka BP)",
colour = "Parameter")+
geom_rect(data=anomaly_min, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="blue", alpha=0.1, inherit.aes = FALSE)+
geom_rect(data=anomaly_max, aes(xmin=xmin, xmax=xmax, ymin=ymin, ymax=ymax), fill="red", alpha=0.05, inherit.aes = FALSE)
print(plot)
